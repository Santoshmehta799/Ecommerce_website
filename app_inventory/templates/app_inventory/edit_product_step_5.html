{% extends 'seventh-square/layout/base.html' %}
{% load static %}
{% block title %}Seller Profile | Seventh Square Seller{% endblock title %}
{% block metablock %}{% endblock metablock %}
{% block cssblock %}
    <link rel="stylesheet" href="{% static 'seventh-square/assets/css/bs-stepper/bs-stepper.min.css' %}" />
    <style>
        .custom-model-min-width{
            min-width: 44.5%;
        }

        .active .bs-stepper-circle {
            background-color: #4C5864;
        }

        .per-w-80{
            width:80% !important;
            display: inline-block !important;
            margin-right:10px;
          }
    </style>
{% endblock cssblock %}
{% block content %}
	<div class="container-fluid">
		<div class="row">
			<!-- Messages Start --> 
				{% include 'seventh-square/layout/messages.html' %}
				{% if error %}
					<div class="alert alert-danger alert-dismissible fade show mb-0" role="alert">
						{{ error|safe }}
						<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
					</div>
				{% endif %}
			<!-- Messages END -->
			<div class="col-12 col-md-12 bg-white">
				<div class="row pl-0">
					<!-- Col-3 is written as sidebar -->
					<div class="custom-sidebar-col-width bg-brand-sidebar d-none d-md-block text-white">
						<div class="row pt-4 px-4">
							<div class="col-12"> {%include 'seventh-square/layout/sidebar.html' %} </div>
						</div>
					</div>
					<div class="custom-main-col-width">
						<div class="row px-4 pt-3">
							<div class="col-md-12">
								<nav aria-label="breadcrumb">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a class="text-dark text-decoration-none" href="/">Home</a></li>
										<li class="breadcrumb-item active" aria-current="page">Edit New Product</li>
									</ol>
								</nav>
							</div>
						</div>
						<div class="row px-4">
							<div class="col-md-12 px-3">
								<h2 class="text-center text-black">Edit New Product</h2>
							</div>
						</div>
						<div class="row mx-2 mb-4">
							<div class="col-12">
                                <div class="card mb-3" id="all_fields_card">
                                    <div class="card-header py-3 text-left bg-brand">
                                        <h3 class="m-0 text-black">Product Details</h3>
                                    </div>
                                    <div class="card-body m-1 p-1">
                                        <div class="mb-5 bg-white shadow-sm">

                                            <div id="stepperForm" class="bs-stepper">
                                                <div class="bs-stepper-header" role="tablist">
                                                    <div class="step" data-target="#stepper-form-1">
                                                        <button type="button" class="step-trigger" role="tab" id="stepperFormTrigger1" aria-controls="stepper-form-1">
                                                            <span class="bs-stepper-circle">1</span>
                                                            <span class="bs-stepper-label">Basic Info</span>
                                                        </button>
                                                    </div>
                                                    <div class="bs-stepper-line"></div>
                                                    <div class="step" data-bs-skip data-target="#stepper-form-2">
                                                        <button type="button" class="step-trigger" role="tab" id="stepperFormTrigger2" aria-controls="#stepper-form-2">
                                                            <span class="bs-stepper-circle">2</span>
                                                            <span class="bs-stepper-label">Variants</span>
                                                        </button>
                                                    </div>
                                                    <div class="bs-stepper-line"></div>
                                                    <div class="step" data-target="#stepper-form-3">
                                                        <button type="button" class="step-trigger" role="tab" id="stepperFormTrigger3" aria-controls="#stepper-form-3">
                                                            <span class="bs-stepper-circle">3</span>
                                                            <span class="bs-stepper-label">More Info</span>
                                                        </button>
                                                    </div>
                                                    <div class="bs-stepper-line"></div>
                                                    <div class="step" data-target="#stepper-form-4">
                                                        <button type="button" class="step-trigger" role="tab" id="stepperFormTrigger4" aria-controls="#stepper-form-4">
                                                            <span class="bs-stepper-circle">4</span>
                                                            <span class="bs-stepper-label"> Pricing</span>
                                                        </button>
                                                    </div>
                                                    <div class="bs-stepper-line"></div>
                                                    <div class="step active" data-target="#stepper-form-5">
                                                        <button type="button" class="step-trigger" role="tab" id="stepperFormTrigger5" aria-controls="#stepper-form-5">
                                                            <span class="bs-stepper-circle">5</span>
                                                            <span class="bs-stepper-label">Shipping</span>
                                                        </button>
                                                    </div>
                                                </div>

                                                <div class="bs-stepper-content">
                                                    <div id="stepper-form-1"  role="tabpanel" class="bs-stepper-pane fade" aria-labelledby="stepperFormTrigger1">
                                                        
                                                    </div>

                                                    <div id="stepper-form-2"  role="tabpanel" class="bs-stepper-pane fade" aria-labelledby="stepperFormTrigger2">
                                                        
                                                    </div>

                                                    <div id="stepper-form-3"  role="tabpanel" class="bs-stepper-pane fade" aria-labelledby="stepperFormTrigger3">
                                                        step 3
                                                    </div>

                                                    <div id="stepper-form-4"  role="tabpanel" class="bs-stepper-pane fade" aria-labelledby="stepperFormTrigger4">
                                                        step 4
                                                    </div>
                                                    
                                                    <div id="stepper-form-5"  role="tabpanel" class="bs-stepper-pane fade active" aria-labelledby="stepperFormTrigger5">
                                                        <form class="needs-validation"  method="POST" id="basic-info-form" novalidate="" enctype="multipart/form-data">
                                                            {% csrf_token %}
                                                            
                                                            <div class="form-row">
                                                                <div class="form-group col-md-7 mb-4">
                                                                    <label class="form-label form-label-normal-font-style" for="id_product_weight">Product Weight</label>
                                                                    <div calss="row">
                                                                        <div class="col-md-4 d-inline-block pl-0">
                                                                            <input type="number" step="0.01" min="0.01" max="99999.99" 
                                                                                name="product_weight" class="form-control"
                                                                                id="id_product_weight" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.product_weight}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" required>
                                                                               
                                                                                <div class="invalid-feedback"></div>
                                                                        </div>
                                                                        <div class="col-md-4 d-inline-block">
                                                                            <select class="form-control"
                                                                                name="product_weight_unit" id="id_product_weight_unit" required>
                                                                                <option value="" disabled selected ></option>
                                                                                {% for product_weights in product_weight %}
                                                                                    <option value="{{ product_weights.0 }}" {% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{% if obj.product_variant_shipping_details.product_weight_unit == product_weights.0  %}selected{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %} >{{ product_weights.1 }}</option>
                                                                                {% endfor %}
                                                                            </select>
                                                                            <div class="invalid-feedback"></div>
                                                                        </div>
                                                                    </div>
                                                                  
                                                                </div>
            
                                                                <div class="form-group col-md-7 mb-4">
                                                                    <label class="form-label form-label-normal-font-style" for="id_returnable_product">Returnable Product</label>
                                                                    <select class="form-control" title="Choose whether your product can be returned by the customer"
                                                                        id="id_returnable_product" onchange="checkReturn()"
                                                                        name="returnable_product" required>
                                                                        <option id="k" value="True" {% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{% if obj.product_variant_shipping_details.returnable_product == True %}selected{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}>Yes</option>
                                                                        <option id="i" value="False" {% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{% if obj.product_variant_shipping_details.returnable_product == False %}selected{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}>No</option>
                                                                        
                                                                    </select>
                                                                    <div class="invalid-feedback"></div>
                                                                   
                                                                </div>
            
                                                                <div class="form-group col-md-7 mb-4" id="id_return_policy_field">
                                                                    <label class="form-label form-label-normal-font-style d-flex justify-content-between" for="id_return_policy">
                                                                        <span>Return policy</span>
                                                                        <span class="optional-color">Optional</span>
                                                                    </label>
                                                                    <input type="text" name="return_policy"  class="form-control" id="id_return_policy" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.return_policy}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" 
                                                                    title="Product / Company specific return policy, if any.">
                                                                </div>
            
                                                                <div class="form-group col-md-7 mb-4">
                                                                    <label class="form-label form-label-normal-font-style" for="id_shipping_method" required>Shipping Method</label>
                                                                    <select class="form-select" title="Choose Shipping method" name="shipping_method" id="id_shipping_method" required>
                                                                        <option value="" disabled selected >Select Shipping Method </option>
                                                                        {% for shipping in shipping_method %}
                                                                            <option value="{{ shipping.0 }}"{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{% if obj.product_variant_shipping_details.shipping_method == shipping.0  %}selected{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}> {{ shipping.1 }}</option>
                                                                        {% endfor %}

                                                                      
                                                                    </select>
                                                                    <div class="invalid-feedback"></div>
                                                                </div>
            
                                                                <div class="form-group col-md-7 mb-4">
                                                                    <label class="form-label form-label-normal-font-style" for="id_product_dimensions_unit">Product Dimensions</label>
                                                                    <select class="form-select"  name="product_dimensions_unit"
                                                                        id="id_product_dimensions_unit" onchange="showPrevie()" required>
                                                                        <option value="" disabled selected >Select Unit </option>
                                                                        {% for product_dimensions in product_dimensions_unit %}
                                                                            <option value="{{ product_dimensions.0 }}" {% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{% if obj.product_variant_shipping_details.product_dimensions_unit == product_dimensions.0  %}selected{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}>{{ product_dimensions.1 }}</option>
                                                                        {% endfor %}
                                                                    </select>
                                                              
                                                                    <div class="row">
                                                                        <div class="col-md-4">
                                                                            <input class="form-control" type="number"
                                                                            name="product_dimensions_length" placeholder="Length
                                                                            " onchange="showPrevie()" id="id_product_dimensions_length"
                                                                            step="any" min="0" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.product_dimensions_length}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" required>
                                                                            <div class="invalid-feedback"></div>
                                                                        </div>
            
                                                                        <div class="col-md-4">
                                                                            <input class="form-control" placeholder="Width" type="number"onchange="showPrevie()"
                                                                                    name="product_dimensions_width" 
                                                                                    id="id_product_dimensions_width" step="any" min="0" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.product_dimensions_width}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" required>
                                                                            <input class="form-control" type="text" onchange="showPrevie()"
                                                                                    id="defpro_mp" name="defaultMP" hidden>
                                                                            <input class="form-control" type="text"
                                                                                    id="defpro_sp" name="defaultSP" onChange="calcuvar()"
                                                                                    hidden>
                                                                            <input class="form-control" type="text"
                                                                                    id="defpro_poq" name="" onChange="calcuvar()" hidden>
                                                                            <input class="form-control" type="text"
                                                                                    id="defpro_var" name="defaultVar" hidden>
                                                                            <div class="invalid-feedback"></div>
                                                                        </div>
                                                                        <div class="col-md-4">
                                                                            <input class="form-control" type="number" name="product_dimensions_height" placeholder="Height" id="id_product_dimensions_height" step="any" onchange="showPrevie()"  min="0" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.product_dimensions_height}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" required>
                                                                            <div class="invalid-feedback"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
            
                                                                <div class="form-group col-md-7 mb-4">
                                                                    <label class="form-label form-label-normal-font-style" for="id_packed_box_dimensions_unit">Packed Box Dimensions</label>
                                                                    <select class="form-select" name="packed_box_dimensions_unit" title="Measurements of the final packaged box that is ready to be delivered."
                                                                        id="id_packed_box_dimensions_unit" onchange="showPrevie()" required>
                                                                        <option value="" disabled selected >Select Unit </option>
                                                                        {% for packed_dimensions in packed_box_dimensions_unit %}
                                                                            <option value="{{ packed_dimensions.0 }}" {% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{% if obj.product_variant_shipping_details.packed_box_dimensions_unit == packed_dimensions.0   %}selected{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %} >{{ packed_dimensions.1 }}</option>
                                                                        {% endfor %}
                                                                    </select>
                                                              
                                                                    <div class="row">
                                                                        <div class="col-md-4">
                                                                            <input class="form-control" placeholder="Length" type="number"
                                                                                name="packed_box_dimensions_length" id="id_packed_box_dimensions_length" onchange="showPrevie()" step="any" min="0" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.packed_box_dimensions_length}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" required>
                                                                            <div class="invalid-feedback"></div>
                                                                        </div>
            
                                                                        <div class="col-md-4">
                                                                            <input class="form-control" type="number" placeholder="Width"
                                                                                   name="packed_box_dimensions_width"
                                                                                   id="id_packed_box_dimensions_width" onchange="showPrevie()" step="any" min="0" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.packed_box_dimensions_width}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" required>
                                                                            <input class="form-control" type="text"
                                                                                   id="defpro_mp" name="boxdefaultMP" hidden>
                                                                            <input class="form-control" type="text"
                                                                                   id="defpro_sp" name="boxdefaultSP" onChange="calcuvar()"
                                                                                   hidden>
                                                                            <input class="form-control" type="text"
                                                                                   id="defpro_poq" name="" onChange="calcuvar()" hidden>
                                                                            <input class="form-control" type="text"
                                                                                   id="defpro_var" name="boxdefaultVar" hidden>
                                                                            <div class="invalid-feedback"></div>
                                                                        </div>
                                                                        <div class="col-md-4">
                                                                            <input class="form-control" type="number"
                                                                                   name="packed_box_dimensions_height" placeholder="Height"
                                                                                   id="id_packed_box_dimensions_height" onchange="showPrevie()" step="any" min="0" value="{% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{{obj.product_variant_shipping_details.packed_box_dimensions_height}}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}" required>
                                                                            <div class="invalid-feedback"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
            
                                                                <div class="form-group col-md-7 mb-4" style="display:none" id="pickup2">
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">
                                                                            Location Name
                                                                            <i style="font-size: 10px;" class="fas fa-question">
                                                                            <span class="tooltiptext">Example: SS Jaipur Warehouse</span></i>
                                                                        </label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="Plocation2" type="text"
                                                                                   placeholder="SS Jaipur Warehouse" name="Plocation2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Plot no </label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="PplotNo2" type="text" placeholder="" name="PplotNo2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Street/Area </label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="Pstreet2" type="text" placeholder="" name="Pstreet2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">City </label>
                                                                        <div class="col-sm-7">
            
                                                                            <input class=" form-control" id="Pcity2" type="text" placeholder="" name="Pcity2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Pin Code </label>
                                                                        <div class="col-sm-7"> 
                                                                            <input class=" form-control" id="Ppincode2" type="text" placeholder="" name="Ppincode2"> 
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">State </label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="Pstate2" type="text" placeholder="" name="Pstate2">
                                                                        </div>
                                                                    </div><div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Plot no </label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="PplotNo2" type="text" placeholder="" name="PplotNo2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Street/Area </label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="Pstreet2" type="text" placeholder="" name="Pstreet2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">City </label>
                                                                        <div class="col-sm-7">
            
                                                                            <input class=" form-control" id="Pcity2" type="text" placeholder="" name="Pcity2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Pin Code </label>
                                                                        <div class="col-sm-7"> 
                                                                            <input class=" form-control" id="Ppincode2" type="text" placeholder="" name="Ppincode2"> 
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">State </label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="Pstate2" type="text" placeholder="" name="Pstate2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Landmark</label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="Plandmark2" type="text" placeholder="" name="Plandmark2">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group row">
                                                                        <label class="col-sm-4 col-form-label requiredLabel" for="">Landmark</label>
                                                                        <div class="col-sm-7">
                                                                            <input class=" form-control" id="Plandmark2" type="text" placeholder="" name="Plandmark2">
                                                                        </div>
                                                                    </div>
                                                                </div>
            
                                                                <div class="form-group col-md-7 mb-4">
                                                                    <div class="row">
                                                                        <div class="col-12">
                                                                            <label class="form-label form-label-normal-font-style">Serviced Regions</label>
                                                                        </div>
                                                                        <div class="col-12 text-left">
                                                                            <input onchange="AddCityPopup(this);" checked title="Please state regions where you want to ship your product in the country. This might influence your delivery cost." style="height:11px; width:11px;" type="radio" class="radio" name="serviced_regions" id="serviced_regions1" value="True" required />
                                                                            <label for="serviced_regions1" class="label_css" style="font-size: 16px;"> I deliver PAN India </label>
                                                                            
                                                                            <input onchange="AddCityPopup(this);" style="height:11px; width:11px;" class="ml-5" title="Please state regions where you want to ship your product in the country. This might influence your delivery cost." type="radio" class="radio" name="serviced_regions" value="False" id="serviced_regions2" required />
                                                                            <label for="serviced_regions2" class=" mt-3" style="font-size: 16px;"> I deliver to specified states / cities only</label>
                                                                                
                                                                        </div>
                                                                        <div id="id_serviced_regionsError" class="invalid-feedback">Please choose one. any fill nacessary detals.</div>
                                                                    </div>
                                                                
                                                                    
            
                                                                    <div class="row mt-3" style="display:none;" id="addStatesModel">
                                                                        <h6 style="text-align: center; cursor: pointer;font-size: 15px;"
                                                                            data-bs-toggle="modal" data-bs-target="#showBreakdon">+Add
                                                                            serviced states & cities </h6>
            
                                                                        <div class="modal fade" id="showBreakdon" tabindex="-1"
                                                                             role="dialog" aria-labelledby="exampleModalLabel"
                                                                             aria-hidden="true">
                                                                            <div class="modal-dialog modal-lg" role="document">
                                                                                <div class="modal-content">
                                                                                    <div class="modal-header">
                                                                                        <h5 class="modal-title" id="exampleModalLabel">
                                                                                            Fill The Details
                                                                                        </h5>
                                                                                        <button type="button" class="btn-close"
                                                                                            data-bs-dismiss="modal" aria-label="Close">
                                                                                        </button>
                                                                                    </div>
                                                                                    <div class="modal-body">
                                                                                        <div class="form-row">
                                                                                            <div class="col-md-12"
                                                                                                style="margin-top: 10px;margin-bottom: 15px;">
                                                                                                <h5>Please Select Your State </h5>
                                                                                                <select id="tagDropdown" class="form-control"></select>
                                                                                                <button type="button" onclick="addSelectedTag()" class="btn btn-brand mt-3 ml-1">Add</button>
                                                                                                <div id="stateTagList" class="mt-3"></div>
                                                                                                <div id="stateErrorText" class="text-danger mt-3" style="display: none;">Tag already exists.</div>
                                                                                               
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="container mb-5"
                                                                                         style="display: flex; justify-content: right;">
                                                                                        <button class="btn btn-brand" data-bs-dismiss="modal" type="submit" >
                                                                                            save
                                                                                        </button>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                      
            
                                                                        <div class="row mt-3">
                                                                            <div class="col-md-3"></div>
                                                                            <div class="col-md-3">
                                                                            <!-- Modal coding with css and js -->
                                                                                
                                                                            </div>
                                                                            <div class="col-md-3"></div>
                                                                            <div class="col-md-3"></div>
            
                                                                        </div>
            
                                                                    </div>
                                                                </div>
            
                                                                <div class="form-group col-md-8" id="wholepick">
                                                                    <label for="id_pick_up_location" class="form-label form-label-normal-font-style">Select Pick Up Location </label>
                                                                    <p> dadsf {% if product_obj.product_has_variant == True %}{% if product_obj.product_variant.all %}{% for obj in product_obj.product_variant.all %}{% if obj.default_variant == True %}{% if obj.product_variant_shipping_details %}{% if obj.product_variant_shipping_details.pick_up_location.all %}{% for pickup_address in obj.product_variant_shipping_details.pick_up_location.all %}{{pickup_address.id}}{% endfor %}{% endif %}{% endif %}{% endif %}{% endfor %}{% endif %}{% endif %}</p>
            
                                                                    <select class="w-100 form-select" title="Delivery Pick up location for your product. These are added first in the Seller Profile and can be selected in multiple for every product." 
                                                                        name="pick_up_location" placeholder="Select pickup location" required  id="id_pick_up_location" 
                                                                        multiple>
                                                                        {% for pickups in pick_up_warehouse_location %}
                                                                            <option value="{{pickups.id}}" >
                                                                            {{pickups.location_name}}, {{pickups.plot_no}}, {{pickups.street}}
                                                                            {{pickups.state}}, {{pickups.city}}, {{pickups.street}}, {{pickups.pin_code}}</option>
                                                                        {% endfor %}
                                                                    </select>
                                                                    
                                                                </div>
                                                            </div>

                                                            <button class="btn btn-dark mt-3">PREV</button>
                                                            <button class="btn btn-brand mt-3 btn-next-form">Next</button>
                                                        </form>
                                                    </div>



                                                </div>


                                            </div>
                                        </div>
                                    </div>
                                </div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock content %}
{% block jsblock %}
    <script rel="stylesheet" href="{% static 'seventh-square/assets/js/bs-stepper/bs-stepper.min.js' %}"></script>  

    <script>
					
		$(document).ready(function () {
			var token = $("input[name=csrfmiddlewaretoken]").val();
	
			$("#basic-info-form").validate({
                rules: {
                    product_weight: {
                        required: true
                    },
                    product_weight_unit: {
                        required: true
                    },
                    returnable_product: {
                        required: true
                    },
                    shipping_method: {
                        required: true 
                    },
                    product_dimensions_unit: {
                        required: true 
                    },
                    product_dimensions_length: {
                        required: true 
                    },
                    product_dimensions_width: {
                        required: true 
                    },
                    product_dimensions_height:{
                        required: true
                    },
                    packed_box_dimensions_unit: {
                        required: true 
                    },
                    packed_box_dimensions_length: {
                        required: true 
                    },
                    packed_box_dimensions_width: {
                        required: true 
                    },
                    packed_box_dimensions_height:{
                        required: true
                    },
                    pick_up_location:{
                        required: true
                    },

                },
                messages: {
                    product_weight: {
                        required: "This field is required."
                    },
                    product_weight_unit: {
                        required: "This field is required."
                    },
                    returnable_product: {
                        required: "This field is required."
                    },
                    shipping_method: {
                        required: "This field is required."
                    },
                    product_dimensions_unit: {
                        required: "This field is required."
                    },
                    product_dimensions_length: {
                        required: "This field is required."
                    },
                    product_dimensions_width: {
                        required: "This field is required."
                    },
                    product_dimensions_height:{
                        required: "This field is required."
                    },
                    packed_box_dimensions_unit: {
                        required: "This field is required."
                    },
                    packed_box_dimensions_length: {
                        required: "This field is required."
                    },
                    packed_box_dimensions_width: {
                        required: "This field is required."
                    },
                    packed_box_dimensions_height:{
                        required: "This field is required."
                    },
                    pick_up_location: {
                        required: "This field is required."
                    },
                }
            });
		});

		{% comment %} except-user-phone-number-check/ {% endcomment %}
	</script>
    <script>
        function truncateDecimal(input) {
            if (input.value.indexOf('.') !== -1) {
                if (input.value.split('.')[1].length > 2) {
                    input.value = parseFloat(input.value).toFixed(2);
                }
            }
        }
    </script>

    <script>
        function checkReturn() {
            var returnable_p = (document.getElementById("id_returnable_product").value);
            if (returnable_p == 'True') {
                $('#id_return_policy_field').show();
            } else {
                $('#id_return_policy_field').hide();
            }
        }
    </script>

    <script> 
        function AddCityPopup(input) {
            const addStatesModel = document.getElementById('addStatesModel');
            //const cityPopupModel = document.getElementById('popup');
            if (input.value === 'True') {
                // If "I deliver PAN India" is selected, hide the addStatesModel
                addStatesModel.style.display = 'none';
                //cityPopupModel.style.display = 'none';
                
            } else {
                // If "I deliver to specified states / cities only" is selected, show the addStatesModel
                addStatesModel.style.display = 'block';
                //cityPopupModel.style.display = 'block';

                // You can also call AddCityPopup here if needed
                //AddCityPopup(input.id); // Assuming you want to pass the input id to the function
            }
        }

        document.addEventListener("DOMContentLoaded", function() {
            // This function will be called when the page finishes loading.
            AddCityPopup();
        });

        
    </script>

    <script>
        const stateDropdown = document.getElementById('tagDropdown');
        const state_arr = {{states_name|safe}};
        const state_id = {{states_id|safe}};
        const stateMapping = {};
        const cityMapping = {};

        for (let i = 0; i < state_id.length; i++) {
            stateMapping[state_id[i]] = state_arr[i];
        }
        console.log(state_arr);
        console.log(state_id);
        console.log(stateMapping);
    
        // Populate the dropdown with options from the state_arr array
        for (let i = 0; i < state_arr.length; i++) {
          const option = document.createElement('option');
          option.value = state_id[i];
          option.textContent = state_arr[i];
          stateDropdown.appendChild(option);
        }
    
        const stateTagList = document.getElementById('stateTagList');
        const stateErrorText = document.getElementById('stateErrorText');
        const tagDropdown = document.getElementById('tagDropdown');
        const addButton = document.getElementById('addButton');
        const MAX_TAGS = 5;
        let tagCount = 0;
    
        function addSelectedTag() {
          const selectedTag = tagDropdown.value;
          if (selectedTag.trim() !== '') {
              if (tagCount < MAX_TAGS) {
                stateErrorText.style.display = 'none';
                addTagVariant(selectedTag, stateTagList);
                tagCount++; // Increment the tag count
                if (tagCount === MAX_TAGS) {
                  addButton.disabled = true;
                }
              } else {
                stateErrorText.style.display = 'block';
                stateErrorText.textContent = 'Maximum limit of ' + MAX_TAGS + ' tags reached.';
              }
          }
        }
    
        function RemoveCurrentSelectedStateTag(StateDeleteLink) {
          const selectedStateColDiv = StateDeleteLink.closest('.selected-state-col');
          if (selectedStateColDiv) {
            selectedStateColDiv.remove();
            tagCount = tagCount-1;
          }
        }
    
        // Create the container div for the tags (outside of any function)
        const tagContainer = document.createElement('div');
        tagContainer.className = 'row m-1';

        
    
        function addTagVariant(tagText, tagList) {
            // Create a div for the select option
            const selectDiv = document.createElement('div');
            selectDiv.className = 'col-4 my-2 selected-state-col';
        
            const hiddenInput = document.createElement('input');
            hiddenInput.type = 'hidden';
            hiddenInput.name = 'servicedRegions[]';
            hiddenInput.value = tagText;
        
            const LabelInput = document.createElement('label');
            LabelInput.textContent = state_arr[tagText];
            LabelInput.className = 'form-label-normal-font-style w-100';
        
            const select = document.createElement('select');
            select.className = 'form-control per-w-80';
            select.required = true
            select.name = 'servicedRegionsDescription[]';
        
            var option = document.createElement('option');
            //option.value = 'None';
            //option.disabled = true;
            //option.selected = true;
            //select.appendChild(option);
        
            var state_id = tagText; 
            var token = document.getElementsByName('csrfmiddlewaretoken')[0].value;
            console.log("url");

            $.ajax({
                url: '/dashboard/load-city-list/',
                type: 'POST',
                data: {'state_id':state_id,'csrfmiddlewaretoken':token},
                success: function(data){
                    console.log('complete successfully.', data);
                        if (data.status == true){
                            //console.log(data.city_id);
                            //console.log(data.city_name);
                            city_arr_name = data.city_name;
                            city_arr_id = data.city_id;

                            for (var i=0; i<city_arr_name.length; i++) {
                                cityMapping[city_arr_id[i]] = city_arr_name[i];
                            }

                            console.log('tagText ->',tagText);
                            console.log('state ->',stateMapping[tagText]);
                            console.log('tagText ->',tagText, cityMapping);


                            //const tagIndex = parseInt(tagText);
                            //var city_arr = s_a[tagIndex].split("|");
                            for (var i=0; i<city_arr_name.length; i++) {
                                var option2 = document.createElement('option'); 
                                option2.value = city_arr_id[i];
                                option2.textContent = city_arr_name[i];
                                select.appendChild(option2);
                            }
                            selectDiv.appendChild(LabelInput);
                            selectDiv.appendChild(hiddenInput);
                            selectDiv.appendChild(select);
                        
                            const StateDeleteLink = document.createElement('a');
                            StateDeleteLink.href = 'javascript:void(0);';
                            StateDeleteLink.className = 'text-danger my-1 mr-1 ml-2';
                            StateDeleteLink.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
                                <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                                </svg>
                                `;
                        
                            StateDeleteLink.addEventListener('click', () => RemoveCurrentSelectedStateTag(StateDeleteLink));
                            // Append the select div to the container
                            selectDiv.appendChild(StateDeleteLink);
                            tagContainer.appendChild(selectDiv);
                        
                            tagList.appendChild(tagContainer);
                            
                        }
                },
                error: function(data){
                    console.log('Check backend is not responding ....');
                },
            });
            
        }
    
    </script>

    <script>
            
        const openModalButtons = document.querySelectorAll('[data-modal-target]')
        const closeModalButtons = document.querySelectorAll('[data-close-button]')
        const overlay = document.getElementById('overlay')

        openModalButtons.forEach(button => {
            button.addEventListener('click', () => {
                const modal = document.querySelector(button.dataset.modalTarget)
                openModal(modal)
            })
        })

        {% comment %} overlay.addEventListener('click', () => {
            const modals = document.querySelectorAll('.modal.active')
            modals.forEach(modal => {
                closeModal(modal)
            })
        }) {% endcomment %}

        closeModalButtons.forEach(button => {
            button.addEventListener('click', () => {
                const modal = button.closest('.modal')
                closeModal(modal)
            })
        })

        function openModal(modal) {
            if (modal == null) return
            modal.classList.add('active')
            overlay.classList.add('active')
        }

        function closeModal(modal) {
            if (modal == null) return
            modal.classList.remove('active')
            overlay.classList.remove('active')
        }
    </script>

    <script>
        {% comment %} $(document).ready(function () {
            $('#pickme').select2({
                theme: 'classic',
                width: '100%',
                maximumSelectionLength: 5
            });
        }); {% endcomment %}
    </script>


    <script>
        let currentValue = 1;

        function generateField() {
            if (currentValue <= 5) {
                const fieldWrapper = document.getElementById(`fieldWrapper${currentValue}`);
                fieldWrapper.style.display = 'block';
                currentValue++;
            }
        }
    </script>
{% endblock jsblock %}